"use strict";(self.webpackChunkfoodstorecms=self.webpackChunkfoodstorecms||[]).push([[154],{8488:(e,a,s)=>{s.d(a,{A:()=>d});var t=s(6213);const r=new(s(4750).A),i=t.A.create({baseURL:"http://localhost:8080/api/v1",headers:{"Content-type":"application/json"}});i.interceptors.request.use((e=>{const a=r.get("token");return a&&(e.headers.Authorization="Bearer ".concat(a)),e}),(e=>Promise.reject(e))),i.interceptors.response.use((e=>e),(e=>{var a,s;const t=(null===(a=e.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.err)||"An unknown error occurred";return Promise.reject(t)}));const d=i},3154:(e,a,s)=>{s.r(a),s.d(a,{default:()=>o});var t=s(5043),r=s(2773),i=s(2539),d=s(3216),c=s(3280),n=s(3892),l=s(579);const o=function(){const[e,a]=(0,t.useState)([]),{updateCartCount:s}=(0,d.KC)(),o=[{id:1,image:"/images/pizza.jpg"},{id:2,image:"/images/burger.jpg"},{id:3,image:"/images/sushi.jpg"},{id:4,image:"/images/cake.jpg"},{id:5,image:"/images/kfc.jpg"},{id:6,image:"/images/bread.jpg"},{id:7,image:"/images/rice.jpg"},{id:8,image:"/images/donut.jpg"},{id:9,image:"/images/banhbao.jpg"},{id:10,image:"/images/trungchien.jpg"},{id:11,image:"/images/thitkhotau.jpg"}];(0,t.useEffect)((()=>{const e=JSON.parse(localStorage.getItem("order"))||[];a(e)}),[]);const m=(0,t.useCallback)(((e,s)=>{a((a=>a.find((a=>a.id===e.id))?a.map((a=>a.id===e.id?{...a,quantity:a.quantity+s}:a)):[...a,{...e,quantity:s}])),console.log(e,s)}),[]),h=(0,t.useCallback)((t=>{const r=e.filter((e=>e.id!==t));a(r),localStorage.setItem("order",JSON.stringify(r)),s()}),[e]),u=(0,t.useCallback)((a=>{m(e.find((e=>e.id===a)),1)}),[e,m]),x=(0,t.useCallback)((a=>{const t=e.find((e=>e.id===a));t&&t.quantity>1?(m(t,-1),s()):h(a),s()}),[e,m,h]),j=(0,t.useMemo)((()=>e.reduce(((e,a)=>e+a.price*(a.quantity||1)),0)),[e]),[p,g]=(0,t.useState)(!1);return(0,l.jsxs)("div",{className:"container my-4",children:[(0,l.jsx)("h2",{className:"text-center mb-4",children:"Shopping Cart"}),(0,l.jsxs)("div",{className:"row",children:[(0,l.jsx)("div",{className:"col-md-8",children:(0,l.jsxs)("div",{className:"card mt-0",children:[(0,l.jsx)("div",{className:"card-header",children:(0,l.jsx)("h4",{className:"card-title",children:"Cart items"})}),(0,l.jsx)("div",{className:"card-body",children:0===e.length?(0,l.jsx)("div",{className:"alert alert-warning text-center",role:"alert",children:"Your Cart is Empty!"}):(0,l.jsxs)("table",{className:"table table-bordered",children:[(0,l.jsx)("thead",{className:"thead-light",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Image"}),(0,l.jsx)("th",{children:"Name Product"}),(0,l.jsx)("th",{children:"Price"}),(0,l.jsx)("th",{children:"Quantity"}),(0,l.jsx)("th",{children:"Cooking Time"}),(0,l.jsx)("th",{children:"Action"})]})}),(0,l.jsx)("tbody",{children:e.map(((e,a)=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:null==e.image||void 0==e.image?(0,l.jsx)("img",{style:{height:"60px"},src:o[a<o.length?a:1].image}):(0,l.jsx)("img",{style:{height:"60px"},src:e.image})}),(0,l.jsx)("td",{children:e.name}),(0,l.jsxs)("td",{children:[e.price," vn\u0111"]}),(0,l.jsxs)("td",{children:[(0,l.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:()=>x(e.id),disabled:(e.quantity||1)<=1,children:"-"}),(0,l.jsx)("span",{className:"mx-2",children:e.quantity||1}),(0,l.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:()=>u(e.id),children:"+"})]}),(0,l.jsxs)("td",{children:[e.cookTime," minute"]}),(0,l.jsx)("td",{children:(0,l.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>h(e.id),children:"Remove"})})]},e.id)))})]})})]})}),(0,l.jsx)("div",{className:"col-md-4",children:(0,l.jsxs)("div",{className:"card mt-0",children:[(0,l.jsx)("div",{className:"card-header",children:(0,l.jsx)("h4",{className:"card-title",children:"Cart Summary"})}),(0,l.jsxs)("div",{className:"card-body",children:[(0,l.jsxs)("div",{className:"row g-3 mb-2",children:[(0,l.jsx)("div",{className:"col-5",children:"Total Items: "}),(0,l.jsx)("div",{className:"col-7",children:e.length}),(0,l.jsx)("div",{className:"col-5",children:"Total Price: "}),(0,l.jsxs)("div",{className:"col-7",children:[j.toFixed(3)," vn\u0111"]})]}),(0,l.jsx)(n.l1,{initialValues:{description:"",promotionCode:"",fullName:"",address:"",paymentMethod:""},validationSchema:c.Ik({description:c.Yj().required("Description is required"),promotionCode:c.Yj(),fullName:c.Yj().required("Name is required"),address:c.Yj().required("Address is required")}),onSubmit:async(t,d)=>{let{resetForm:c}=d;const n=e.map((e=>({menuId:e.id,quantity:e.quantity,note:e.note||""}))),l={description:t.description,promotionCode:t.promotionCode,fullName:t.fullName,address:t.address,status:"WAITING",detailList:n};try{g(!0);await i.A.createOrder(l);r.A.success("\u0110\u01a1n h\xe0ng \u0111\xe3 \u0111\u01b0\u1ee3c t\u1ea1o"),a([]),localStorage.removeItem("order"),s();const e=window.bootstrap.Modal.getInstance(document.getElementById("paymentModal"));e&&e.hide()}catch(o){r.A.error("L\u1ed7i khi t\u1ea1o \u0111\u01a1n h\xe0ng"),console.error("Error creating order",o)}finally{g(!1)}},children:a=>{let{touched:s,errors:t,setFieldTouched:r,submitForm:i,validateForm:d}=a;return(0,l.jsxs)(n.lV,{children:[(0,l.jsxs)("div",{className:"row g-3",children:[(0,l.jsx)("div",{className:"col-5 d-flex align-items-center",children:"Description:"}),(0,l.jsxs)("div",{className:"col-7",children:[(0,l.jsx)(n.D0,{className:"form-control",name:"description",type:"text"}),s.description&&t.description?(0,l.jsx)("div",{className:"text-danger",children:t.description}):null]}),(0,l.jsx)("div",{className:"col-5 d-flex align-items-center",children:"Promotion Code:"}),(0,l.jsx)("div",{className:"col-7",children:(0,l.jsx)(n.D0,{className:"form-control",name:"promotionCode",type:"text"})}),(0,l.jsx)("div",{className:"col-5 d-flex align-items-center",children:"Full name:"}),(0,l.jsxs)("div",{className:"col-7",children:[(0,l.jsx)(n.D0,{className:"form-control",name:"fullName",type:"text"}),s.fullName&&t.fullName?(0,l.jsx)("div",{className:"text-danger",children:t.fullName}):null]}),(0,l.jsx)("div",{className:"col-5 d-flex align-items-center",children:"Address:"}),(0,l.jsxs)("div",{className:"col-7",children:[(0,l.jsx)(n.D0,{className:"form-control",name:"address",type:"text"}),s.address&&t.address?(0,l.jsx)("div",{className:"text-danger",children:t.address}):null]})]}),(0,l.jsx)("button",{type:"button",onClick:()=>(async(e,a)=>{await a("description",!0),await a("promotionCode",!0),await a("fullName",!0),await a("address",!0);const s=await e();0===Object.keys(s).length?new window.bootstrap.Modal(document.getElementById("paymentModal")).show():console.log("Form validation failed",s)})(d,r),className:"btn btn-primary mt-4 w-100",disabled:0===e.length,children:"Buy"}),(0,l.jsx)("div",{className:"modal fade",id:"paymentModal",children:(0,l.jsx)("div",{className:"modal-dialog",children:(0,l.jsxs)("div",{className:"modal-content",children:[(0,l.jsx)("div",{className:"modal-header",children:(0,l.jsx)("h4",{className:"mb-2",children:"Confirm payment"})}),(0,l.jsxs)("div",{className:"modal-body",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"d-flex",children:[(0,l.jsx)("input",{className:"form-check me-2",type:"radio",name:"paymentMethod",value:"creditCard"}),"Credit Card"]}),(0,l.jsxs)("div",{className:"d-flex",children:[(0,l.jsx)("input",{className:"form-check me-2",type:"radio",name:"paymentMethod",value:"paypal"}),"PayPal"]}),(0,l.jsxs)("div",{className:"d-flex",children:[(0,l.jsx)("input",{className:"form-check me-2",type:"radio",name:"paymentMethod",value:"cashOnDelivery"}),"Cash on Delivery"]})]}),(0,l.jsx)("textarea",{className:"form-control mt-2",placeholder:"Note for shop"})]}),(0,l.jsx)("div",{className:"modal-footer",children:(0,l.jsx)("button",{className:"btn btn-primary",onClick:()=>{i(),g(!0)},disabled:p,children:"Confirm Payment"})})]})})})]})}})]})]})})]})]})}},2539:(e,a,s)=>{s.d(a,{A:()=>r});var t=s(8488);const r={getOrderList:async function(e){try{return(await t.A.get("/order-dish",{params:{status:e}})).data}catch(a){throw a}},createOrder:async function(e){try{return(await t.A.post("/order-dish",e)).data}catch(a){throw a}},detailOrder:async function(e){try{return(await t.A.get("/order-dish/".concat(e))).data}catch(a){throw a}},updateOrder:async function(e,a){try{return(await t.A.put("/order-dish/".concat(e),a)).data}catch(s){throw s}},cancelOrder:async function(e){try{return(await t.A.delete("/order-dish/".concat(e))).data}catch(a){throw a}},respondToOrder:async function(e,a){try{return(await t.A.post("/order-dish/".concat(e,"/response"),a)).data}catch(s){throw s}},confirmPayment:async function(e,a){try{return(await t.A.put("/orders/payment/".concat(e),a)).data}catch(s){throw s}},shipOrder:async function(e,a){try{return(await t.A.put("/orders/shipping/".concat(e),a)).data}catch(s){throw s}},changeOrderStatus:async function(e,a){try{return(await t.A.post("cms/order-dish/".concat(e,"/status"),a)).data}catch(s){throw s}}}}}]);
//# sourceMappingURL=154.7b56aceb.chunk.js.map